@import "tailwindcss";

@config '../tailwind.config.ts';

@plugin "@tailwindcss/typography";
@import "tw-animate-css";

@source "../app/**/*.{js,ts,jsx,tsx,mdx}";
@source "../components/**/*.{js,ts,jsx,tsx,mdx}";
@source "../pages/**/*.{js,ts,jsx,tsx,mdx}";
@source "../src/**/*.{ts,tsx}";

@source "../node_modules/streamdown/dist/index.js";

/*
  The default border color has changed to `currentcolor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentcolor);
  }
}

@utility text-balance {
  text-wrap: balance;
}

@utility scrollbar-thin {
  scrollbar-width: thin;

  &::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  &::-webkit-scrollbar-track {
    background: transparent;
  }

  &::-webkit-scrollbar-thumb {
    background-color: hsl(var(--muted-foreground) / 0.3);
    border-radius: 3px;
  }

  &::-webkit-scrollbar-thumb:hover {
    background-color: hsl(var(--muted-foreground) / 0.5);
  }
}

@utility react-grid-item {
  &.react-grid-placeholder {
    @apply bg-accent/40! border-2! border-dashed! border-accent! rounded-lg! opacity-100! transition-all! duration-200! backdrop-blur-xs! shadow-[0_0_0_1px_hsl(var(--accent)/0.4)]! origin-center!;
  }

  &.react-draggable-dragging {
    @apply transition-none! z-100! cursor-grabbing! opacity-90!;
  }

  & > .react-resizable-handle {
    @apply rounded-br-sm;
  }

  @media (max-width: 768px) {
    @apply select-none;

    &[data-customizing='true'] {
      @apply touch-none;
    }

    & [data-scrollable='true'] {
      @apply touch-pan-y;
      -webkit-overflow-scrolling: touch;
    }
  }
}

@utility react-grid-placeholder {
  &.react-grid-item {
    @apply bg-accent/40! border-2! border-dashed! border-accent! rounded-lg! opacity-100! transition-all! duration-200! backdrop-blur-xs! shadow-[0_0_0_1px_hsl(var(--accent)/0.4)]! origin-center!;
  }
}

@utility react-draggable-dragging {
  &.react-grid-item {
    @apply transition-none! z-100! cursor-grabbing! opacity-90!;
  }
}

@utility react-resizable-handle {
  .react-grid-item > & {
    @apply rounded-br-sm;
  }
}

@utility touch-hitbox {
  position: relative;

  &::before {
    content: '';
    position: absolute;
    display: block;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 100%;
    height: 100%;
    min-height: 44px;
    min-width: 44px;
    z-index: 9999;
  }
}

@layer utilities {
  :root {
    --foreground-rgb: 0, 0, 0;
    --background-start-rgb: 214, 219, 220;
    --background-end-rgb: 255, 255, 255;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --foreground-rgb: 255, 255, 255;
      --background-start-rgb: 0, 0, 0;
      --background-end-rgb: 0, 0, 0;
    }
  }
}

@layer base {
  :root {
    --background: 0 0% var(--theme-intensity, 100%);
    --foreground: 0 0% 3.9%;
    --card: 0 0% var(--theme-intensity, 100%);
    --card-foreground: 0 0% 3.9%;
    --popover: 0 0% var(--theme-intensity, 100%);
    --popover-foreground: 0 0% 3.9%;
    --primary: 0 0% 9%;
    --primary-foreground: 0 0% 98%;
    --secondary: 0 0% 96.1%;
    --secondary-foreground: 0 0% 9%;
    --muted: 0 0% 96.1%;
    --muted-foreground: 0 0% 45.1%;
    --accent: 0 0% 96.1%;
    --accent-foreground: 0 0% 9%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --success: 173 58% 39%;
    --success-foreground: 355.7 100% 97.3%;
    --border: 0 0% 89.8%;
    --input: 0 0% 89.8%;
    --ring: 0 0% 3.9%;
    --radius: 0.5rem;
    --sidebar-background: 0 0% var(--theme-intensity, 98%);
    --sidebar-foreground: 240 5.3% 26.1%;
    --sidebar-primary: 240 5.9% 10%;
    --sidebar-primary-foreground: 0 0% 98%;
    --sidebar-accent: 240 4.8% 95.9%;
    --sidebar-accent-foreground: 240 5.9% 10%;
    --sidebar-border: 220 13% 91%;
    --sidebar-ring: 217.2 91.2% 59.8%;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    /* Refined to keep palette consistency beyond first five */
    --chart-6: 206 72% 50%; /* blue */
    --chart-7: 260 60% 55%; /* purple */
    --chart-8: 336 70% 58%; /* rose */
    --chart-loss: 12 76% 61%;
    --chart-win: 173 58% 39%;
  }

  .dark {
    --background: 0 0% calc(100% - var(--theme-intensity, 100%));
    --foreground: 0 0% 98%;
    --card: 0 0% calc(100% - var(--theme-intensity, 100%));
    --card-foreground: 0 0% 98%;
    --popover: 0 0% calc(100% - var(--theme-intensity, 100%));
    --popover-foreground: 0 0% 98%;
    --primary: 0 0% 98%;
    --primary-foreground: 0 0% 9%;
    --secondary: 0 0% 14.9%;
    --secondary-foreground: 0 0% 98%;
    --muted: 0 0% 14.9%;
    --muted-foreground: 0 0% 63.9%;
    --accent: 0 0% 14.9%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --success: 173 58% 39%;
    --success-foreground: 144.9 80.4% 10%;
    --border: 0 0% 14.9%;
    --input: 0 0% 14.9%;
    --ring: 0 0% 83.1%;
    --sidebar-background: 240 5.9% calc(100% - var(--theme-intensity, 100%));
    --sidebar-foreground: 240 4.8% 95.9%;
    --sidebar-primary: 224.3 76.3% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 3.7% 15.9%;
    --sidebar-accent-foreground: 240 4.8% 95.9%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 217.2 91.2% 59.8%;
    /* Dark theme realigned to mirror light theme hues for consistency */
    --chart-1: 217 91% 60%;   /* blue */
    --chart-2: 173 60% 55%;  /* teal-green */
    --chart-3: 197 55% 60%;  /* blue-gray */
    --chart-4: 43 85% 60%;   /* golden yellow */
    --chart-5: 27 85% 60%;   /* orange */
    --chart-6: 206 80% 60%;  /* blue */
    --chart-7: 260 65% 65%;  /* purple */
    --chart-8: 336 70% 65%;  /* rose */
    --chart-loss: 12 75% 65%;
    --chart-win: 173 60% 55%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
  img {
    @apply inline-block;
  } 
}

@layer utilities {
  .no-select {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

@layer utilities {
  /* Code block styles */
  pre {
    overflow-x: auto;
    padding: 1rem 0;
  }

  pre [data-line] {
    padding: 0 1rem;
  }

  pre [data-highlighted-line] {
    background: rgba(200, 200, 255, 0.1);
    padding: 0 1rem;
    width: 100%;
    display: block;
    position: relative;
  }

  pre [data-highlighted-line]::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    width: 2px;
    height: 100%;
    background: #60a5fa;
  }

  pre [data-highlighted-chars] {
    background: rgba(200, 200, 255, 0.1);
    padding: 2px;
    border-radius: 2px;
  }

  code {
    counter-reset: line;
  }

  code > [data-line]::before {
    counter-increment: line;
    content: counter(line);
    display: inline-block;
    width: 1rem;
    margin-right: 1rem;
    text-align: right;
    color: gray;
  }

  .prose pre {
    margin: 0;
    padding: 0;
    background: transparent;
  }

  .prose pre code {
    font-size: 0.875em;
    line-height: 1.7142857;
    display: block;
    overflow-x: auto;
    border-radius: 0.375rem;
  }

  /* MDX Typography Overrides */
  .prose {
    --tw-prose-body: var(--color-neutral-700);
    --tw-prose-headings: var(--color-neutral-900);
    --tw-prose-links: var(--color-neutral-900);
    --tw-prose-links-hover: var(--color-neutral-800);
    --tw-prose-underline: var(--color-neutral-400);
    --tw-prose-underline-hover: var(--color-neutral-800);
    --tw-prose-bold: var(--color-neutral-900);
    --tw-prose-counters: var(--color-neutral-500);
    --tw-prose-bullets: var(--color-neutral-300);
    --tw-prose-hr: var(--color-neutral-200);
    --tw-prose-quote-borders: var(--color-neutral-200);
    --tw-prose-captions: var(--color-neutral-500);
    --tw-prose-code: var(--color-neutral-900);
    --tw-prose-code-bg: var(--color-neutral-100);
    --tw-prose-pre-code: var(--color-neutral-200);
    --tw-prose-pre-bg: var(--color-neutral-800);
    --tw-prose-pre-border: transparent;
    --tw-prose-th-borders: var(--color-neutral-200);
    --tw-prose-td-borders: var(--color-neutral-100);
  }

  .dark .prose {
    --tw-prose-body: var(--color-neutral-300);
    --tw-prose-headings: var(--color-neutral-100);
    --tw-prose-links: var(--color-neutral-100);
    --tw-prose-links-hover: var(--color-neutral-200);
    --tw-prose-underline: var(--color-neutral-600);
    --tw-prose-underline-hover: var(--color-neutral-200);
    --tw-prose-bold: var(--color-neutral-100);
    --tw-prose-counters: var(--color-neutral-400);
    --tw-prose-bullets: var(--color-neutral-600);
    --tw-prose-hr: var(--color-neutral-700);
    --tw-prose-quote-borders: var(--color-neutral-700);
    --tw-prose-captions: var(--color-neutral-400);
    --tw-prose-code: var(--color-neutral-200);
    --tw-prose-code-bg: var(--color-neutral-800);
    --tw-prose-pre-code: var(--color-neutral-100);
    --tw-prose-pre-bg: var(--color-neutral-900);
    --tw-prose-pre-border: transparent;
    --tw-prose-th-borders: var(--color-neutral-700);
    --tw-prose-td-borders: var(--color-neutral-800);
  }

  /* Remove underline from anchor links wrapping headings (from rehype-autolink-headings) */
  .prose a.anchor,
  .prose .anchor,
  .prose h1 a,
  .prose h2 a,
  .prose h3 a,
  .prose h4 a,
  .prose h5 a,
  .prose h6 a,
  .prose h1 > a,
  .prose h2 > a,
  .prose h3 > a,
  .prose h4 > a,
  .prose h5 > a,
  .prose h6 > a {
    text-decoration: none !important;
    text-decoration-line: none !important;
    text-decoration-color: transparent !important;
    text-decoration-thickness: 0 !important;
  }

  .dark .prose a.anchor,
  .dark .prose .anchor,
  .dark .prose h1 a,
  .dark .prose h2 a,
  .dark .prose h3 a,
  .dark .prose h4 a,
  .dark .prose h5 a,
  .dark .prose h6 a,
  .dark .prose h1 > a,
  .dark .prose h2 > a,
  .dark .prose h3 > a,
  .dark .prose h4 > a,
  .dark .prose h5 > a,
  .dark .prose h6 > a {
    text-decoration: none !important;
    text-decoration-line: none !important;
    text-decoration-color: transparent !important;
    text-decoration-thickness: 0 !important;
  }
}

@layer components {

  [data-radix-popper-content-wrapper] {
    @apply z-9999!;
  }
}

@layer utilities {
  /* Mobile navbar overlay styles */
  body[data-mobile-navbar='open'] .max-w-screen-xl {
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
  }

  body[data-mobile-navbar='open'] .max-w-screen-xl > * {
    pointer-events: none;
  }

  /* Hide accordion arrow for theme selector */
  [data-accordion-trigger] [data-accordion-icon] {
    display: none;
  }

  /* Shimmer animation for AI loading states */
  @keyframes shimmer {
    0% {
      transform: translateX(-100%);
    }
    100% {
      transform: translateX(100%);
    }
  }

  .animate-shimmer {
    animation: shimmer 2s ease-in-out infinite;
  }
}

@utility touch-hitbox {
  position: relative;
 
  &::before {
    content: "";
    position: absolute;
    display: block;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 100%;
    height: 100%;
    min-height: 44px;
    min-width: 44px;
    z-index: 9999;
  }
}